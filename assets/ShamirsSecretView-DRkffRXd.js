import{_ as J,r as G,w as W,c as z,g as _,f as N,s as Z,e as V,P as H,b as E,y as K,z as Q,i as x,F as O,k as D,t as k,j as X,p as Y}from"./index-Bh-oM7fR.js";import{a as ee,g as te,_ as re}from"./Tabs-BxRB77I2.js";import{_ as ne,a as ae,b as F}from"./NumberRange-DzpSQW-s.js";function ie(B){throw new Error('Could not dynamically require "'+B+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var A={exports:{}};const se={},oe=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),ue=ee(oe);var L;function le(){return L||(L=1,function(B){(function(p,d){var c={bits:8,radix:16,minBits:3,maxBits:20,bytesPerChar:2,maxBytesPerChar:6,primitivePolynomials:[null,null,1,3,3,5,3,3,29,17,9,5,83,27,43,3,45,9,39,39,9,5,3,33,27,9,71,39,9,5,83],warning:`WARNING:
A secure random number generator was not found.
Using Math.random(), which is NOT cryptographically strong!`},r={};p.getConfig=function(){return{bits:r.bits,unsafePRNG:r.unsafePRNG}};function b(e){if(e&&(typeof e!="number"||e%1!==0||e<c.minBits||e>c.maxBits))throw new Error("Number of bits must be an integer between "+c.minBits+" and "+c.maxBits+", inclusive.");r.radix=c.radix,r.bits=e||c.bits,r.size=Math.pow(2,r.bits),r.max=r.size-1;for(var t=[],a=[],n=1,s=c.primitivePolynomials[r.bits],i=0;i<r.size;i++)a[i]=n,t[n]=i,n<<=1,n>=r.size&&(n^=s,n&=r.max);r.logs=t,r.exps=a}p.init=b;function R(){return!(!r.bits||!r.size||!r.max||!r.logs||!r.exps||r.logs.length!==r.size||r.exps.length!==r.size)}function C(){var e,t;function a(i,o,l,u){for(var m="",g=0,w=o.length-1;g<w||m.length<i;)m+=y(parseInt(o[g],l).toString(2),u),g++;return m=m.substr(-i),(m.match(/0/g)||[]).length===m.length?null:m}if(typeof ie=="function"&&(t=ue)&&(e=t.randomBytes))return function(i){for(var o=Math.ceil(i/8),l=null;l===null;)l=a(i,e(o).toString("hex"),16,4);return l};if(d.crypto&&typeof d.crypto.getRandomValues=="function"&&typeof d.Uint32Array=="function")return t=d.crypto,function(i){for(var o=Math.ceil(i/32),l=null,u=new d.Uint32Array(o);l===null;)t.getRandomValues(u),l=a(i,u,10,32);return l};r.unsafePRNG=!0,M();var n=32,s=Math.pow(2,n)-1;return function(i){for(var o=Math.ceil(i/n),l=[],u=null;u===null;){for(var m=0;m<o;m++)l[m]=Math.floor(Math.random()*s+1);u=a(i,l,10,n)}return u}}function M(){d.console.warn(c.warning),typeof d.alert=="function"&&r.alert&&d.alert(c.warning)}p.setRNG=function(e,t){if(R()||this.init(),r.unsafePRNG=!1,e=e||C(),typeof e!="function"||typeof e(r.bits)!="string"||!parseInt(e(r.bits),2)||e(r.bits).length>r.bits||e(r.bits).length<r.bits)throw new Error("Random number generator is invalid. Supply an RNG of the form function(bits){} that returns a string containing 'bits' number of random 1's and 0's.");return r.rng=e,r.alert=!!t,!!r.unsafePRNG};function h(){return typeof r.rng=="function"}p.random=function(e){if(h()||this.setRNG(),typeof e!="number"||e%1!==0||e<2)throw new Error("Number of bits must be an integer greater than 1.");return r.unsafePRNG&&M(),I(r.rng(e))},p.share=function(e,t,a,n,s){if(R()||this.init(),h()||this.setRNG(),n=n||0,typeof e!="string")throw new Error("Secret must be a string.");if(typeof t!="number"||t%1!==0||t<2)throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.");if(t>r.max){var i=Math.ceil(Math.log(t+1)/Math.LN2);throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive. To create "+t+" shares, use at least "+i+" bits.")}if(typeof a!="number"||a%1!==0||a<2)throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.");if(a>r.max){var i=Math.ceil(Math.log(a+1)/Math.LN2);throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.  To use a threshold of "+a+", use at least "+i+" bits.")}if(typeof n!="number"||n%1!==0)throw new Error("Zero-pad length must be an integer greater than 1.");r.unsafePRNG&&M(),e="1"+$(e),e=T(e,n);for(var o=new Array(t),l=new Array(t),u=0,m=e.length;u<m;u++)for(var g=this._getShares(e[u],t,a),w=0;w<t;w++)o[w]=o[w]||g[w].x.toString(r.radix),l[w]=y(g[w].y.toString(2))+(l[w]?l[w]:"");var j=r.max.toString(r.radix).length;if(s)for(var u=0;u<t;u++)o[u]=I(l[u]);else for(var u=0;u<t;u++)o[u]=r.bits.toString(36).toUpperCase()+y(o[u],j)+I(l[u]);return o},p._getShares=function(e,t,a){for(var n=[],s=[e],i=1;i<a;i++)s[i]=parseInt(r.rng(r.bits),2);for(var i=1,o=t+1;i<o;i++)n[i-1]={x:i,y:f(i,s)};return n};function f(e,t){for(var a=r.logs[e],n=0,s=t.length-1;s>=0;s--){if(n===0){n=t[s];continue}n=r.exps[(a+r.logs[n])%r.max]^t[s]}return n}function v(e,t){for(var a=0,n=e.length;a<n;a++)if(e[a]===t)return!0;return!1}function S(e){var t=parseInt(e[0],36);if(t&&(typeof t!="number"||t%1!==0||t<c.minBits||t>c.maxBits))throw new Error("Number of bits must be an integer between "+c.minBits+" and "+c.maxBits+", inclusive.");var a=Math.pow(2,t)-1,n=a.toString(r.radix).length,s=parseInt(e.substr(1,n),r.radix);if(typeof s!="number"||s%1!==0||s<1||s>a)throw new Error("Share id must be an integer between 1 and "+r.max+", inclusive.");if(e=e.substr(n+1),!e.length)throw new Error("Invalid share: zero-length share.");return{bits:t,id:s,value:e}}p._processShare=S;function q(e,t){for(var a,n,s=[],i=[],o="",l,u=0,m=t.length;u<m;u++){if(n=S(t[u]),typeof a>"u")a=n.bits;else if(n.bits!==a)throw new Error("Mismatched shares: Different bit settings.");if(r.bits!==a&&b(a),!v(s,n.id)){l=s.push(n.id)-1,n=T($(n.value));for(var g=0,w=n.length;g<w;g++)i[g]=i[g]||[],i[g][l]=n[g]}}for(var u=0,m=i.length;u<m;u++)o=y(U(e,s,i[u]).toString(2))+o;if(e===0){var l=o.indexOf("1");return I(o.slice(l+1))}else return I(o)}p.combine=function(e){return q(0,e)},p.newShare=function(e,t){typeof e=="string"&&(e=parseInt(e,r.radix));var a=S(t[0]),n=Math.pow(2,a.bits)-1;if(typeof e!="number"||e%1!==0||e<1||e>n)throw new Error("Share id must be an integer between 1 and "+r.max+", inclusive.");var s=n.toString(r.radix).length;return r.bits.toString(36).toUpperCase()+y(e.toString(r.radix),s)+q(e,t)};function U(e,t,a){for(var n=0,s,i,o,i=0,l=t.length;i<l;i++)if(a[i]){s=r.logs[a[i]];for(var o=0;o<l;o++)if(i!==o){if(e===t[o]){s=-1;break}s=(s+r.logs[e^t[o]]-r.logs[t[i]^t[o]]+r.max)%r.max}n=s===-1?n:n^r.exps[s]}return n}p._lagrange=U;function T(e,t){t&&(e=y(e,t));for(var a=[],n=e.length;n>r.bits;n-=r.bits)a.push(parseInt(e.slice(n-r.bits,n),2));return a.push(parseInt(e.slice(0,n),2)),a}function y(e,t){t=t||r.bits;var a=e.length%t;return(a?new Array(t-a+1).join("0"):"")+e}function $(e){for(var t="",a,n=e.length-1;n>=0;n--){if(a=parseInt(e[n],16),isNaN(a))throw new Error("Invalid hex character.");t=y(a.toString(2),4)+t}return t}function I(e){var t="",a;e=y(e,4);for(var n=e.length;n>=4;n-=4){if(a=parseInt(e.slice(n-4,n),2),isNaN(a))throw new Error("Invalid binary character.");t=a.toString(16)+t}return t}p.str2hex=function(e,t){if(typeof e!="string")throw new Error("Input must be a character string.");if(t=t||c.bytesPerChar,typeof t!="number"||t%1!==0||t<1||t>c.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+c.maxBytesPerChar+", inclusive.");for(var a=2*t,n=Math.pow(16,a)-1,s="",i,o=0,l=e.length;o<l;o++){if(i=e[o].charCodeAt(),isNaN(i))throw new Error("Invalid character: "+e[o]);if(i>n){var u=Math.ceil(Math.log(i+1)/Math.log(256));throw new Error("Invalid character code ("+i+"). Maximum allowable is 256^bytes-1 ("+n+"). To convert this character, use at least "+u+" bytes.")}else s=y(i.toString(16),a)+s}return s},p.hex2str=function(e,t){if(typeof e!="string")throw new Error("Input must be a hexadecimal string.");if(t=t||c.bytesPerChar,typeof t!="number"||t%1!==0||t<1||t>c.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+c.maxBytesPerChar+", inclusive.");var a=2*t,n="";e=y(e,a);for(var s=0,i=e.length;s<i;s+=a)n=String.fromCharCode(parseInt(e.slice(s,s+a),16))+n;return n},p.init()})(B.exports?B.exports:window.secrets={},typeof GLOBAL<"u"?GLOBAL:window)}(A)),A.exports}var ce=le();const P=te(ce),fe={class:"page page-shamirs-secret-sharing"},de={key:0},pe={class:"list-row"},me={key:1},he={style:{display:"flex","margin-bottom":"12px"}},ve={style:{"margin-right":"12px"}},ge=["onUpdate:modelValue","id"],we=["onClick"],be={class:"list-row"},ye={__name:"ShamirsSecretView",setup(B){const p=G({available:["Split secret","Combine parts"],selected:"Split secret"}),d=G({secret:"My secret",parts:3,requiredParts:2});W(d,h=>{h.requiredParts>h.parts&&(d.value.requiredParts=h.parts)},{deep:!0});const c=z(()=>{const h=P.str2hex(d.value.secret);return P.share(h,d.value.parts,d.value.requiredParts)}),r=()=>{b.value=JSON.parse(JSON.stringify(c.value)),p.value.selected="Combine parts"},b=G(["","",""]),R=z(()=>C()),C=()=>{try{const h=P.combine(b.value.filter(f=>!!f));return P.hex2str(h)}catch(h){return console.error("cannot combine parts",h),"Error! See console log."}};function M(h){b.value.splice(h,1)}return(h,f)=>(E(),_("div",fe,[N(H,null,{icon:V(()=>[N(Q)]),default:V(()=>[f[5]||(f[5]=K(" Shamir's secret sharing "))]),_:1,__:[5]}),f[8]||(f[8]=Z('<p data-v-d44d9a6c> Using secrets.js → <a href="https://github.com/scrtlabs/secret.js" data-v-d44d9a6c>Github</a>, <a href="https://www.npmjs.com/package/secretjs" data-v-d44d9a6c>NPM</a></p><p data-v-d44d9a6c> See this code → <a href="https://github.com/peferb/fun-utils/blob/main/src/views/ShamirsSecretView.vue" data-v-d44d9a6c>ShamirsSecretView.vue</a></p><h2 data-v-d44d9a6c>About</h2><p data-v-d44d9a6c> Use &quot;Split secret&quot; to split a secret into how many parts you want, and select &quot;Required parts&quot; to how many parts you want to be used to restore the secret. </p><p data-v-d44d9a6c> Flip to &quot;Combine parts&quot; to restore the secret using the parts you&#39;ve created. Or just use the button to auto copy all the parts to the &quot;Combine parts&quot; tab. </p><p data-v-d44d9a6c><a href="https://en.wikipedia.org/wiki/Shamir%27s_secret_sharing" data-v-d44d9a6c>Wikipedia about Shamir&#39;s secret sharing</a></p>',6)),N(re,{modelValue:p.value.selected,"onUpdate:modelValue":f[4]||(f[4]=v=>p.value.selected=v),tabs:p.value.available,style:{"margin-top":"24px"}},{default:V(()=>[p.value.selected==="Split secret"?(E(),_("div",de,[N(ne,{id:"secret-input",label:"Secret",modelValue:d.value.secret,"onUpdate:modelValue":f[0]||(f[0]=v=>d.value.secret=v)},null,8,["modelValue"]),N(ae,{"max-columns":"two"},{default:V(()=>[N(F,{id:"parts-input",label:"Parts",modelValue:d.value.parts,"onUpdate:modelValue":f[1]||(f[1]=v=>d.value.parts=v),min:2,max:100},null,8,["modelValue"]),N(F,{id:"required-parts-input",label:"Required parts",modelValue:d.value.requiredParts,"onUpdate:modelValue":f[2]||(f[2]=v=>d.value.requiredParts=v),min:2,max:d.value.parts},null,8,["modelValue","max"])]),_:1}),x("div",{style:{display:"flex","justify-content":"center","align-items":"center","margin-top":"8px"}},[x("button",{onClick:r,style:{width:"max-content"}},"Copy parts to 'Combine parts'   →")]),f[6]||(f[6]=x("h2",null,"Secret parts",-1)),(E(!0),_(O,null,D(c.value,v=>(E(),_("div",pe,k(v),1))),256))])):(E(),_("div",me,[x("div",he,[x("div",ve,"Parts #"+k(b.value.length),1),x("button",{onClick:f[3]||(f[3]=()=>b.value.push("")),style:{width:"max-content"}},"Add part")]),(E(!0),_(O,null,D(b.value,(v,S)=>(E(),_("div",{ref_for:!0,ref:`combine-part-${S}`,key:v,style:{display:"flex",margin:"4px 0"}},[X(x("input",{"onUpdate:modelValue":q=>b.value[S]=q,id:`parts-input-${S}`,type:"text",style:{width:"100%"}},null,8,ge),[[Y,b.value[S]]]),x("div",{onClick:q=>M(S),class:"delete-action",title:"Delete this row"}," ✖ ",8,we)]))),128)),f[7]||(f[7]=x("h2",null,"Restored secret",-1)),x("div",be,k(R.value),1)]))]),_:1},8,["modelValue","tabs"])]))}},Ne=J(ye,[["__scopeId","data-v-d44d9a6c"]]);export{Ne as default};
