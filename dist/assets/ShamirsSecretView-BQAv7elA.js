import{_ as L,r as G,w as J,c as T,a as N,g as E,f as B,e as V,P as W,s as Z,z as H,y as K,i as _,F as $,k as z,t as O,j as Q,p as X}from"./index-7GBxHX35.js";import{_ as Y}from"./Tabs-CQIHW11b.js";import{_ as ee,a as te,b as j}from"./NumberRange-Cz9ER3C-.js";function re(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}function ne(m){if(m.__esModule)return m;var d=m.default;if(typeof d=="function"){var f=function l(){return this instanceof l?Reflect.construct(d,arguments,this.constructor):d.apply(this,arguments)};f.prototype=d.prototype}else f={};return Object.defineProperty(f,"__esModule",{value:!0}),Object.keys(m).forEach(function(l){var r=Object.getOwnPropertyDescriptor(m,l);Object.defineProperty(f,l,r.get?r:{enumerable:!0,get:function(){return m[l]}})}),f}function ae(m){throw new Error('Could not dynamically require "'+m+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var D={exports:{}};const ie={},oe=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),se=ne(oe);(function(m){(function(d,f){var l={bits:8,radix:16,minBits:3,maxBits:20,bytesPerChar:2,maxBytesPerChar:6,primitivePolynomials:[null,null,1,3,3,5,3,3,29,17,9,5,83,27,43,3,45,9,39,39,9,5,3,33,27,9,71,39,9,5,83],warning:`WARNING:
A secure random number generator was not found.
Using Math.random(), which is NOT cryptographically strong!`},r={};d.getConfig=function(){return{bits:r.bits,unsafePRNG:r.unsafePRNG}};function y(e){if(e&&(typeof e!="number"||e%1!==0||e<l.minBits||e>l.maxBits))throw new Error("Number of bits must be an integer between "+l.minBits+" and "+l.maxBits+", inclusive.");r.radix=l.radix,r.bits=e||l.bits,r.size=Math.pow(2,r.bits),r.max=r.size-1;for(var t=[],a=[],n=1,o=l.primitivePolynomials[r.bits],i=0;i<r.size;i++)a[i]=n,t[n]=i,n<<=1,n>=r.size&&(n^=o,n&=r.max);r.logs=t,r.exps=a}d.init=y;function R(){return!(!r.bits||!r.size||!r.max||!r.logs||!r.exps||r.logs.length!==r.size||r.exps.length!==r.size)}function C(){var e,t;function a(i,s,c,u){for(var h="",w=0,b=s.length-1;w<b||h.length<i;)h+=x(parseInt(s[w],c).toString(2),u),w++;return h=h.substr(-i),(h.match(/0/g)||[]).length===h.length?null:h}if(typeof ae=="function"&&(t=se)&&(e=t.randomBytes))return function(i){for(var s=Math.ceil(i/8),c=null;c===null;)c=a(i,e(s).toString("hex"),16,4);return c};if(f.crypto&&typeof f.crypto.getRandomValues=="function"&&typeof f.Uint32Array=="function")return t=f.crypto,function(i){for(var s=Math.ceil(i/32),c=null,u=new f.Uint32Array(s);c===null;)t.getRandomValues(u),c=a(i,u,10,32);return c};r.unsafePRNG=!0,M();var n=32,o=Math.pow(2,n)-1;return function(i){for(var s=Math.ceil(i/n),c=[],u=null;u===null;){for(var h=0;h<s;h++)c[h]=Math.floor(Math.random()*o+1);u=a(i,c,10,n)}return u}}function M(){f.console.warn(l.warning),typeof f.alert=="function"&&r.alert&&f.alert(l.warning)}d.setRNG=function(e,t){if(R()||this.init(),r.unsafePRNG=!1,e=e||C(),typeof e!="function"||typeof e(r.bits)!="string"||!parseInt(e(r.bits),2)||e(r.bits).length>r.bits||e(r.bits).length<r.bits)throw new Error("Random number generator is invalid. Supply an RNG of the form function(bits){} that returns a string containing 'bits' number of random 1's and 0's.");return r.rng=e,r.alert=!!t,!!r.unsafePRNG};function v(){return typeof r.rng=="function"}d.random=function(e){if(v()||this.setRNG(),typeof e!="number"||e%1!==0||e<2)throw new Error("Number of bits must be an integer greater than 1.");return r.unsafePRNG&&M(),P(r.rng(e))},d.share=function(e,t,a,n,o){if(R()||this.init(),v()||this.setRNG(),n=n||0,typeof e!="string")throw new Error("Secret must be a string.");if(typeof t!="number"||t%1!==0||t<2)throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.");if(t>r.max){var i=Math.ceil(Math.log(t+1)/Math.LN2);throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive. To create "+t+" shares, use at least "+i+" bits.")}if(typeof a!="number"||a%1!==0||a<2)throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.");if(a>r.max){var i=Math.ceil(Math.log(a+1)/Math.LN2);throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.  To use a threshold of "+a+", use at least "+i+" bits.")}if(typeof n!="number"||n%1!==0)throw new Error("Zero-pad length must be an integer greater than 1.");r.unsafePRNG&&M(),e="1"+U(e),e=A(e,n);for(var s=new Array(t),c=new Array(t),u=0,h=e.length;u<h;u++)for(var w=this._getShares(e[u],t,a),b=0;b<t;b++)s[b]=s[b]||w[b].x.toString(r.radix),c[b]=x(w[b].y.toString(2))+(c[b]?c[b]:"");var F=r.max.toString(r.radix).length;if(o)for(var u=0;u<t;u++)s[u]=P(c[u]);else for(var u=0;u<t;u++)s[u]=r.bits.toString(36).toUpperCase()+x(s[u],F)+P(c[u]);return s},d._getShares=function(e,t,a){for(var n=[],o=[e],i=1;i<a;i++)o[i]=parseInt(r.rng(r.bits),2);for(var i=1,s=t+1;i<s;i++)n[i-1]={x:i,y:p(i,o)};return n};function p(e,t){for(var a=r.logs[e],n=0,o=t.length-1;o>=0;o--){if(n===0){n=t[o];continue}n=r.exps[(a+r.logs[n])%r.max]^t[o]}return n}function g(e,t){for(var a=0,n=e.length;a<n;a++)if(e[a]===t)return!0;return!1}function S(e){var t=parseInt(e[0],36);if(t&&(typeof t!="number"||t%1!==0||t<l.minBits||t>l.maxBits))throw new Error("Number of bits must be an integer between "+l.minBits+" and "+l.maxBits+", inclusive.");var a=Math.pow(2,t)-1,n=a.toString(r.radix).length,o=parseInt(e.substr(1,n),r.radix);if(typeof o!="number"||o%1!==0||o<1||o>a)throw new Error("Share id must be an integer between 1 and "+r.max+", inclusive.");if(e=e.substr(n+1),!e.length)throw new Error("Invalid share: zero-length share.");return{bits:t,id:o,value:e}}d._processShare=S;function I(e,t){for(var a,n,o=[],i=[],s="",c,u=0,h=t.length;u<h;u++){if(n=S(t[u]),typeof a>"u")a=n.bits;else if(n.bits!==a)throw new Error("Mismatched shares: Different bit settings.");if(r.bits!==a&&y(a),!g(o,n.id)){c=o.push(n.id)-1,n=A(U(n.value));for(var w=0,b=n.length;w<b;w++)i[w]=i[w]||[],i[w][c]=n[w]}}for(var u=0,h=i.length;u<h;u++)s=x(k(e,o,i[u]).toString(2))+s;if(e===0){var c=s.indexOf("1");return P(s.slice(c+1))}else return P(s)}d.combine=function(e){return I(0,e)},d.newShare=function(e,t){typeof e=="string"&&(e=parseInt(e,r.radix));var a=S(t[0]),n=Math.pow(2,a.bits)-1;if(typeof e!="number"||e%1!==0||e<1||e>n)throw new Error("Share id must be an integer between 1 and "+r.max+", inclusive.");var o=n.toString(r.radix).length;return r.bits.toString(36).toUpperCase()+x(e.toString(r.radix),o)+I(e,t)};function k(e,t,a){for(var n=0,o,i,s,i=0,c=t.length;i<c;i++)if(a[i]){o=r.logs[a[i]];for(var s=0;s<c;s++)if(i!==s){if(e===t[s]){o=-1;break}o=(o+r.logs[e^t[s]]-r.logs[t[i]^t[s]]+r.max)%r.max}n=o===-1?n:n^r.exps[o]}return n}d._lagrange=k;function A(e,t){t&&(e=x(e,t));for(var a=[],n=e.length;n>r.bits;n-=r.bits)a.push(parseInt(e.slice(n-r.bits,n),2));return a.push(parseInt(e.slice(0,n),2)),a}function x(e,t){t=t||r.bits;var a=e.length%t;return(a?new Array(t-a+1).join("0"):"")+e}function U(e){for(var t="",a,n=e.length-1;n>=0;n--){if(a=parseInt(e[n],16),isNaN(a))throw new Error("Invalid hex character.");t=x(a.toString(2),4)+t}return t}function P(e){var t="",a;e=x(e,4);for(var n=e.length;n>=4;n-=4){if(a=parseInt(e.slice(n-4,n),2),isNaN(a))throw new Error("Invalid binary character.");t=a.toString(16)+t}return t}d.str2hex=function(e,t){if(typeof e!="string")throw new Error("Input must be a character string.");if(t=t||l.bytesPerChar,typeof t!="number"||t%1!==0||t<1||t>l.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+l.maxBytesPerChar+", inclusive.");for(var a=2*t,n=Math.pow(16,a)-1,o="",i,s=0,c=e.length;s<c;s++){if(i=e[s].charCodeAt(),isNaN(i))throw new Error("Invalid character: "+e[s]);if(i>n){var u=Math.ceil(Math.log(i+1)/Math.log(256));throw new Error("Invalid character code ("+i+"). Maximum allowable is 256^bytes-1 ("+n+"). To convert this character, use at least "+u+" bytes.")}else o=x(i.toString(16),a)+o}return o},d.hex2str=function(e,t){if(typeof e!="string")throw new Error("Input must be a hexadecimal string.");if(t=t||l.bytesPerChar,typeof t!="number"||t%1!==0||t<1||t>l.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+l.maxBytesPerChar+", inclusive.");var a=2*t,n="";e=x(e,a);for(var o=0,i=e.length;o<i;o+=a)n=String.fromCharCode(parseInt(e.slice(o,o+a),16))+n;return n},d.init()})(m.exports?m.exports:window.secrets={},typeof GLOBAL<"u"?GLOBAL:window)})(D);var ue=D.exports;const q=re(ue),le={class:"page page-shamirs-secret-sharing"},ce={key:0},fe={class:"list-row"},de={key:1},pe={style:{display:"flex","margin-bottom":"12px"}},me={style:{"margin-right":"12px"}},he=["onUpdate:modelValue","id"],ve=["onClick"],ge={class:"list-row"},we={__name:"ShamirsSecretView",setup(m){const d=G({available:["Split secret","Combine parts"],selected:"Split secret"}),f=G({secret:"My secret",parts:3,requiredParts:2});J(f,v=>{v.requiredParts>v.parts&&(f.value.requiredParts=v.parts)},{deep:!0});const l=T(()=>{const v=q.str2hex(f.value.secret);return q.share(v,f.value.parts,f.value.requiredParts)}),r=()=>{y.value=JSON.parse(JSON.stringify(l.value)),d.value.selected="Combine parts"},y=G(["","",""]),R=T(()=>C()),C=()=>{try{const v=q.combine(y.value.filter(p=>!!p));return q.hex2str(v)}catch(v){return console.error("cannot combine parts",v),"Error! See console log."}};function M(v){y.value.splice(v,1)}return(v,p)=>(N(),E("div",le,[B(W,null,{icon:V(()=>[B(H)]),default:V(()=>[p[5]||(p[5]=K(" Shamir's secret sharing "))]),_:1}),p[8]||(p[8]=Z('<p data-v-d44d9a6c> Using secrets.js → <a href="https://github.com/scrtlabs/secret.js" data-v-d44d9a6c>Github</a>, <a href="https://www.npmjs.com/package/secretjs" data-v-d44d9a6c>NPM</a></p><p data-v-d44d9a6c> See this code → <a href="https://github.com/peferb/fun-utils/blob/main/src/views/ShamirsSecretView.vue" data-v-d44d9a6c>ShamirsSecretView.vue</a></p><h2 data-v-d44d9a6c>About</h2><p data-v-d44d9a6c> Use &quot;Split secret&quot; to split a secret into how many parts you want, and select &quot;Required parts&quot; to how many parts you want to be used to restore the secret. </p><p data-v-d44d9a6c> Flip to &quot;Combine parts&quot; to restore the secret using the parts you&#39;ve created. Or just use the button to auto copy all the parts to the &quot;Combine parts&quot; tab. </p><p data-v-d44d9a6c><a href="https://en.wikipedia.org/wiki/Shamir%27s_secret_sharing" data-v-d44d9a6c>Wikipedia about Shamir&#39;s secret sharing</a></p>',6)),B(Y,{modelValue:d.value.selected,"onUpdate:modelValue":p[4]||(p[4]=g=>d.value.selected=g),tabs:d.value.available,style:{"margin-top":"24px"}},{default:V(()=>[d.value.selected==="Split secret"?(N(),E("div",ce,[B(ee,{id:"secret-input",label:"Secret",modelValue:f.value.secret,"onUpdate:modelValue":p[0]||(p[0]=g=>f.value.secret=g)},null,8,["modelValue"]),B(te,{"max-columns":"two"},{default:V(()=>[B(j,{id:"parts-input",label:"Parts",modelValue:f.value.parts,"onUpdate:modelValue":p[1]||(p[1]=g=>f.value.parts=g),min:2,max:100},null,8,["modelValue"]),B(j,{id:"required-parts-input",label:"Required parts",modelValue:f.value.requiredParts,"onUpdate:modelValue":p[2]||(p[2]=g=>f.value.requiredParts=g),min:2,max:f.value.parts},null,8,["modelValue","max"])]),_:1}),_("div",{style:{display:"flex","justify-content":"center","align-items":"center","margin-top":"8px"}},[_("button",{onClick:r,style:{width:"max-content"}},"Copy parts to 'Combine parts'   →")]),p[6]||(p[6]=_("h2",null,"Secret parts",-1)),(N(!0),E($,null,z(l.value,g=>(N(),E("div",fe,O(g),1))),256))])):(N(),E("div",de,[_("div",pe,[_("div",me,"Parts #"+O(y.value.length),1),_("button",{onClick:p[3]||(p[3]=()=>y.value.push("")),style:{width:"max-content"}},"Add part")]),(N(!0),E($,null,z(y.value,(g,S)=>(N(),E("div",{ref_for:!0,ref:`combine-part-${S}`,key:g,style:{display:"flex",margin:"4px 0"}},[Q(_("input",{"onUpdate:modelValue":I=>y.value[S]=I,id:`parts-input-${S}`,type:"text",style:{width:"100%"}},null,8,he),[[X,y.value[S]]]),_("div",{onClick:I=>M(S),class:"delete-action",title:"Delete this row"}," ✖ ",8,ve)]))),128)),p[7]||(p[7]=_("h2",null,"Restored secret",-1)),_("div",ge,O(R.value),1)]))]),_:1},8,["modelValue","tabs"])]))}},_e=L(we,[["__scopeId","data-v-d44d9a6c"]]);export{_e as default};
