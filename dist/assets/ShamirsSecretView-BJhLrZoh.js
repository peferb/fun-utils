import{r as q,w as J,c as $,a as E,g as S,f as B,e as V,P as W,i as y,x as C,y as Z,F as z,k as D,t as A,j as H,p as K}from"./index-Cbl4p2iK.js";import{c as Q,_ as X,a as Y,b as j}from"./Tabs-CBdAVK1l.js";function ee(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}function te(p){if(p.__esModule)return p;var m=p.default;if(typeof m=="function"){var f=function l(){return this instanceof l?Reflect.construct(m,arguments,this.constructor):m.apply(this,arguments)};f.prototype=m.prototype}else f={};return Object.defineProperty(f,"__esModule",{value:!0}),Object.keys(p).forEach(function(l){var r=Object.getOwnPropertyDescriptor(p,l);Object.defineProperty(f,l,r.get?r:{enumerable:!0,get:function(){return p[l]}})}),f}function re(p){throw new Error('Could not dynamically require "'+p+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var L={exports:{}};const ne={},ae=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"})),ie=te(ae);(function(p){(function(m,f){var l={bits:8,radix:16,minBits:3,maxBits:20,bytesPerChar:2,maxBytesPerChar:6,primitivePolynomials:[null,null,1,3,3,5,3,3,29,17,9,5,83,27,43,3,45,9,39,39,9,5,3,33,27,9,71,39,9,5,83],warning:`WARNING:
A secure random number generator was not found.
Using Math.random(), which is NOT cryptographically strong!`},r={};m.getConfig=function(){return{bits:r.bits,unsafePRNG:r.unsafePRNG}};function x(e){if(e&&(typeof e!="number"||e%1!==0||e<l.minBits||e>l.maxBits))throw new Error("Number of bits must be an integer between "+l.minBits+" and "+l.maxBits+", inclusive.");r.radix=l.radix,r.bits=e||l.bits,r.size=Math.pow(2,r.bits),r.max=r.size-1;for(var t=[],a=[],n=1,o=l.primitivePolynomials[r.bits],i=0;i<r.size;i++)a[i]=n,t[n]=i,n<<=1,n>=r.size&&(n^=o,n&=r.max);r.logs=t,r.exps=a}m.init=x;function R(){return!(!r.bits||!r.size||!r.max||!r.logs||!r.exps||r.logs.length!==r.size||r.exps.length!==r.size)}function O(){var e,t;function a(i,s,c,u){for(var d="",w=0,b=s.length-1;w<b||d.length<i;)d+=_(parseInt(s[w],c).toString(2),u),w++;return d=d.substr(-i),(d.match(/0/g)||[]).length===d.length?null:d}if(typeof re=="function"&&(t=ie)&&(e=t.randomBytes))return function(i){for(var s=Math.ceil(i/8),c=null;c===null;)c=a(i,e(s).toString("hex"),16,4);return c};if(f.crypto&&typeof f.crypto.getRandomValues=="function"&&typeof f.Uint32Array=="function")return t=f.crypto,function(i){for(var s=Math.ceil(i/32),c=null,u=new f.Uint32Array(s);c===null;)t.getRandomValues(u),c=a(i,u,10,32);return c};r.unsafePRNG=!0,M();var n=32,o=Math.pow(2,n)-1;return function(i){for(var s=Math.ceil(i/n),c=[],u=null;u===null;){for(var d=0;d<s;d++)c[d]=Math.floor(Math.random()*o+1);u=a(i,c,10,n)}return u}}function M(){f.console.warn(l.warning),typeof f.alert=="function"&&r.alert&&f.alert(l.warning)}m.setRNG=function(e,t){if(R()||this.init(),r.unsafePRNG=!1,e=e||O(),typeof e!="function"||typeof e(r.bits)!="string"||!parseInt(e(r.bits),2)||e(r.bits).length>r.bits||e(r.bits).length<r.bits)throw new Error("Random number generator is invalid. Supply an RNG of the form function(bits){} that returns a string containing 'bits' number of random 1's and 0's.");return r.rng=e,r.alert=!!t,!!r.unsafePRNG};function h(){return typeof r.rng=="function"}m.random=function(e){if(h()||this.setRNG(),typeof e!="number"||e%1!==0||e<2)throw new Error("Number of bits must be an integer greater than 1.");return r.unsafePRNG&&M(),I(r.rng(e))},m.share=function(e,t,a,n,o){if(R()||this.init(),h()||this.setRNG(),n=n||0,typeof e!="string")throw new Error("Secret must be a string.");if(typeof t!="number"||t%1!==0||t<2)throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.");if(t>r.max){var i=Math.ceil(Math.log(t+1)/Math.LN2);throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive. To create "+t+" shares, use at least "+i+" bits.")}if(typeof a!="number"||a%1!==0||a<2)throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.");if(a>r.max){var i=Math.ceil(Math.log(a+1)/Math.LN2);throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+r.max+"), inclusive.  To use a threshold of "+a+", use at least "+i+" bits.")}if(typeof n!="number"||n%1!==0)throw new Error("Zero-pad length must be an integer greater than 1.");r.unsafePRNG&&M(),e="1"+U(e),e=T(e,n);for(var s=new Array(t),c=new Array(t),u=0,d=e.length;u<d;u++)for(var w=this._getShares(e[u],t,a),b=0;b<t;b++)s[b]=s[b]||w[b].x.toString(r.radix),c[b]=_(w[b].y.toString(2))+(c[b]?c[b]:"");var F=r.max.toString(r.radix).length;if(o)for(var u=0;u<t;u++)s[u]=I(c[u]);else for(var u=0;u<t;u++)s[u]=r.bits.toString(36).toUpperCase()+_(s[u],F)+I(c[u]);return s},m._getShares=function(e,t,a){for(var n=[],o=[e],i=1;i<a;i++)o[i]=parseInt(r.rng(r.bits),2);for(var i=1,s=t+1;i<s;i++)n[i-1]={x:i,y:v(i,o)};return n};function v(e,t){for(var a=r.logs[e],n=0,o=t.length-1;o>=0;o--){if(n===0){n=t[o];continue}n=r.exps[(a+r.logs[n])%r.max]^t[o]}return n}function g(e,t){for(var a=0,n=e.length;a<n;a++)if(e[a]===t)return!0;return!1}function N(e){var t=parseInt(e[0],36);if(t&&(typeof t!="number"||t%1!==0||t<l.minBits||t>l.maxBits))throw new Error("Number of bits must be an integer between "+l.minBits+" and "+l.maxBits+", inclusive.");var a=Math.pow(2,t)-1,n=a.toString(r.radix).length,o=parseInt(e.substr(1,n),r.radix);if(typeof o!="number"||o%1!==0||o<1||o>a)throw new Error("Share id must be an integer between 1 and "+r.max+", inclusive.");if(e=e.substr(n+1),!e.length)throw new Error("Invalid share: zero-length share.");return{bits:t,id:o,value:e}}m._processShare=N;function P(e,t){for(var a,n,o=[],i=[],s="",c,u=0,d=t.length;u<d;u++){if(n=N(t[u]),typeof a>"u")a=n.bits;else if(n.bits!==a)throw new Error("Mismatched shares: Different bit settings.");if(r.bits!==a&&x(a),!g(o,n.id)){c=o.push(n.id)-1,n=T(U(n.value));for(var w=0,b=n.length;w<b;w++)i[w]=i[w]||[],i[w][c]=n[w]}}for(var u=0,d=i.length;u<d;u++)s=_(k(e,o,i[u]).toString(2))+s;if(e===0){var c=s.indexOf("1");return I(s.slice(c+1))}else return I(s)}m.combine=function(e){return P(0,e)},m.newShare=function(e,t){typeof e=="string"&&(e=parseInt(e,r.radix));var a=N(t[0]),n=Math.pow(2,a.bits)-1;if(typeof e!="number"||e%1!==0||e<1||e>n)throw new Error("Share id must be an integer between 1 and "+r.max+", inclusive.");var o=n.toString(r.radix).length;return r.bits.toString(36).toUpperCase()+_(e.toString(r.radix),o)+P(e,t)};function k(e,t,a){for(var n=0,o,i,s,i=0,c=t.length;i<c;i++)if(a[i]){o=r.logs[a[i]];for(var s=0;s<c;s++)if(i!==s){if(e===t[s]){o=-1;break}o=(o+r.logs[e^t[s]]-r.logs[t[i]^t[s]]+r.max)%r.max}n=o===-1?n:n^r.exps[o]}return n}m._lagrange=k;function T(e,t){t&&(e=_(e,t));for(var a=[],n=e.length;n>r.bits;n-=r.bits)a.push(parseInt(e.slice(n-r.bits,n),2));return a.push(parseInt(e.slice(0,n),2)),a}function _(e,t){t=t||r.bits;var a=e.length%t;return(a?new Array(t-a+1).join("0"):"")+e}function U(e){for(var t="",a,n=e.length-1;n>=0;n--){if(a=parseInt(e[n],16),isNaN(a))throw new Error("Invalid hex character.");t=_(a.toString(2),4)+t}return t}function I(e){var t="",a;e=_(e,4);for(var n=e.length;n>=4;n-=4){if(a=parseInt(e.slice(n-4,n),2),isNaN(a))throw new Error("Invalid binary character.");t=a.toString(16)+t}return t}m.str2hex=function(e,t){if(typeof e!="string")throw new Error("Input must be a character string.");if(t=t||l.bytesPerChar,typeof t!="number"||t%1!==0||t<1||t>l.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+l.maxBytesPerChar+", inclusive.");for(var a=2*t,n=Math.pow(16,a)-1,o="",i,s=0,c=e.length;s<c;s++){if(i=e[s].charCodeAt(),isNaN(i))throw new Error("Invalid character: "+e[s]);if(i>n){var u=Math.ceil(Math.log(i+1)/Math.log(256));throw new Error("Invalid character code ("+i+"). Maximum allowable is 256^bytes-1 ("+n+"). To convert this character, use at least "+u+" bytes.")}else o=_(i.toString(16),a)+o}return o},m.hex2str=function(e,t){if(typeof e!="string")throw new Error("Input must be a hexadecimal string.");if(t=t||l.bytesPerChar,typeof t!="number"||t%1!==0||t<1||t>l.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+l.maxBytesPerChar+", inclusive.");var a=2*t,n="";e=_(e,a);for(var o=0,i=e.length;o<i;o+=a)n=String.fromCharCode(parseInt(e.slice(o,o+a),16))+n;return n},m.init()})(p.exports?p.exports:window.secrets={},typeof GLOBAL<"u"?GLOBAL:window)})(L);var oe=L.exports;const G=ee(oe),se={class:"page page-shamirs-secret-sharing"},ue=y("p",null,[C(" Using secrets.js: "),y("a",{href:"https://github.com/scrtlabs/secret.js"},"Github"),C(", "),y("a",{href:"https://www.npmjs.com/package/secretjs"},"NPM"),C(". ")],-1),le={key:0},ce=y("h2",null,"Secret parts",-1),fe={class:"list-row"},me={key:1},pe={style:{display:"flex","margin-bottom":"12px"}},de={style:{"margin-right":"12px"}},he=["onUpdate:modelValue","id"],ve=["onClick"],ge=y("h2",null,"Restored secret",-1),we={class:"list-row"},xe={__name:"ShamirsSecretView",setup(p){const m=q({available:["Split secret","Combine parts"],selected:"Split secret"}),f=q({secret:"My secret",parts:3,requiredParts:2});J(f,h=>{h.requiredParts>h.parts&&(f.value.requiredParts=h.parts)},{deep:!0});const l=$(()=>{const h=G.str2hex(f.value.secret);return G.share(h,f.value.parts,f.value.requiredParts)}),r=()=>{x.value=JSON.parse(JSON.stringify(l.value)),m.value.selected="Combine parts"},x=q(["","",""]),R=$(()=>O()),O=()=>{try{const h=G.combine(x.value.filter(v=>!!v));return G.hex2str(h)}catch(h){return console.error("cannot combine parts",h),"Error! See console log."}};function M(h){x.value.splice(h,1)}return(h,v)=>(E(),S("div",se,[B(W,null,{icon:V(()=>[B(Z)]),default:V(()=>[C(" Shamir's secret sharing ")]),_:1}),ue,B(Q,{modelValue:m.value.selected,"onUpdate:modelValue":v[4]||(v[4]=g=>m.value.selected=g),tabs:m.value.available},{default:V(()=>[m.value.selected==="Split secret"?(E(),S("div",le,[B(X,{id:"secret-input",label:"Secret",modelValue:f.value.secret,"onUpdate:modelValue":v[0]||(v[0]=g=>f.value.secret=g)},null,8,["modelValue"]),B(Y,{"max-columns":"two"},{default:V(()=>[B(j,{id:"parts-input",label:"Parts",modelValue:f.value.parts,"onUpdate:modelValue":v[1]||(v[1]=g=>f.value.parts=g),min:2,max:100},null,8,["modelValue"]),B(j,{id:"required-parts-input",label:"Required parts",modelValue:f.value.requiredParts,"onUpdate:modelValue":v[2]||(v[2]=g=>f.value.requiredParts=g),min:2,max:f.value.parts},null,8,["modelValue","max"])]),_:1}),y("div",{style:{display:"flex","justify-content":"center","align-items":"center","margin-top":"8px"}},[y("button",{onClick:r,style:{width:"max-content"}},"Copy parts to 'Combine parts'   →")]),ce,(E(!0),S(z,null,D(l.value,g=>(E(),S("div",fe,A(g),1))),256))])):(E(),S("div",me,[y("div",pe,[y("div",de,"Parts #"+A(x.value.length),1),y("button",{onClick:v[3]||(v[3]=()=>x.value.push("")),style:{width:"max-content"}},"Add part")]),(E(!0),S(z,null,D(x.value,(g,N)=>(E(),S("div",{ref_for:!0,ref:`combine-part-${N}`,key:g,style:{display:"flex",margin:"4px 0"}},[H(y("input",{"onUpdate:modelValue":P=>x.value[N]=P,id:`parts-input-${N}`,type:"text",style:{width:"100%"}},null,8,he),[[K,x.value[N]]]),y("div",{onClick:P=>M(N),class:"delete-action",title:"Delete this row"}," ✖ ",8,ve)]))),128)),ge,y("div",we,A(R.value),1)]))]),_:1},8,["modelValue","tabs"])]))}};export{xe as default};
